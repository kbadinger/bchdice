{"ast":null,"code":"var _jsxFileName = \"/Users/kevinbadinger/eos/reactdemo/WCWReact/src/components/droplist.jsx\";\nimport { JsonRpc } from \"eosjs\";\nimport { deserialize, ObjectSchema } from \"atomicassets\";\nimport React from \"react\";\nimport { Button, Card, CardHeader, Typography, CardContent, Grid } from \"@material-ui/core\";\nimport Form from \"react-bootstrap/Form\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./droplist.css\";\nconst defaultState = {\n  activeUser: null,\n  accountName: \"\",\n  dropItems: \"\",\n  drops: [],\n  statusDisplay: \"\",\n  loading: false\n};\nvar ourNetwork = {\n  chainId: \"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4\",\n  rpcEndpoints: [{\n    protocol: \"https\",\n    host: \"chain.wax.io\",\n    port: \"\"\n  }]\n};\nconst picture = {\n  height: \"250px\",\n  width: \"150px\"\n};\nconst cardstyleGreen = {\n  border: 10,\n  borderColor: \"green\",\n  borderStyle: \"solid\"\n};\nconst cardstyleRed = {\n  border: 10,\n  borderColor: \"red\",\n  borderStyle: \"solid\"\n};\n\nclass DropListApp extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.renderLogoutBtn = () => {};\n\n    this.handleDropUpdate = event => {\n      let etv = event.target.value;\n      this.setState(state => ({ ...this.state,\n        dropItems: etv\n      }));\n    };\n\n    this.searchDrop = async event => {\n      var lb = \"0\";\n      var newAsset = \"1\";\n      var haveCollection = {};\n\n      while (lb !== newAsset) {\n        newAsset = lb;\n        let resp = await this.searchAssets(lb);\n\n        for (let itemNdx in resp.rows) {\n          lb = resp.rows[itemNdx].asset_id;\n          var tid = resp.rows[itemNdx].template_id;\n          const searchIndex = this.state.drops.findIndex(d => d.template_id === resp.rows[itemNdx].template_id);\n\n          if (searchIndex >= 0) {\n            let itm = this.state.drops[searchIndex];\n            itm.numberHad++;\n            haveCollection[tid] = 1;\n            this.state.drops[searchIndex] = itm;\n            this.setState(state => ({ ...this.state,\n              have: Object.keys(haveCollection).length,\n              drops: this.state.drops.sort(function (a, b) {\n                return a.numberHad - b.numberHad;\n              })\n            }));\n          }\n        }\n      }\n    };\n\n    this.renderDropForm = () => {\n      const {\n        dropItems\n      } = this.state;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          position: \"absolute\",\n          zIndex: \"10\",\n          top: \"0\",\n          left: \"0\",\n          width: '400px',\n          height: '400px',\n          backgroundImage: URl('./Square-1s-200px.gif')\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 1\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginLeft: \"auto\",\n          marginRight: \"auto\",\n          width: \"100%\",\n          marginTop: \"40px\",\n          display: \"table\",\n          marginBottom: \"10px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          position: \"relative\",\n          verticalAlign: \"middle\",\n          width: \"100%\",\n          display: \"table-cell\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        style: {\n          marginBottom: \"40px\",\n          textAlign: \"center\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }\n      }, \"Draco Dice BCH Physical Collection Tools\"), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          width: \"550px\",\n          margin: \"auto\",\n          verticalAlign: \"middle\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Form, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        controlId: \"dropItems\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          width: \"150%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          width: \"300px\",\n          float: \"left\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        type: \"text\",\n        name: \"dropItems\",\n        placeholder: \"Wallet\",\n        value: dropItems,\n        onChange: this.handleDropUpdate,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginLeft: \"305px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        onClick: this.searchDrop,\n        variant: \"contained\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 21\n        }\n      }, \"Search\")))), /*#__PURE__*/React.createElement(Typography, {\n        variant: \"subtitle2\",\n        component: \"h2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 15\n        }\n      }, this.state.statusDisplay))), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          margin: \"auto\",\n          textAlign: \"center\",\n          verticalAlign: \"middle\",\n          paddingBottom: \"50px\",\n          paddingTop: \"25px\",\n          width: \"900px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 13\n        }\n      }, \"BCH Collection Draco Dice (Have \", this.state.have, \" of\", \" \", this.state.ctr, \")\"), /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        spacing: 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }\n      }, this.state.drops.map(function (item, i) {\n        var _item$collection_name, _item$drop_id;\n\n        var desc = item.name;\n        var have = item.numberHad;\n        let img = \"\";\n\n        if (item.imgTag != null && item.imgTag.length > 0) {\n          img = /*#__PURE__*/React.createElement(\"img\", {\n            style: picture,\n            src: item.imgTag,\n            alt: \"bch dice\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 25\n            }\n          });\n        }\n\n        return /*#__PURE__*/React.createElement(Grid, {\n          item: true,\n          xs: 12,\n          sm: 6,\n          md: 4,\n          key: item.drop_id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(Card, {\n          style: have > 0 ? cardstyleGreen : cardstyleRed,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(CardHeader, {\n          title: (_item$collection_name = item.collection_name) !== null && _item$collection_name !== void 0 ? _item$collection_name : \"\",\n          subheader: (_item$drop_id = item.drop_id) !== null && _item$drop_id !== void 0 ? _item$drop_id : \"\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 23\n          }\n        }), /*#__PURE__*/React.createElement(CardContent, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 23\n          }\n        }, img, /*#__PURE__*/React.createElement(Typography, {\n          variant: \"body2\",\n          color: \"textSecondary\",\n          component: \"p\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 25\n          }\n        }, desc, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 27\n          }\n        }), \"Number of Assets: \", have))));\n      }))))), \" \");\n    };\n\n    this.state = { ...defaultState,\n      rows: [],\n      drops: [],\n      ctr: 0,\n      have: 0,\n      rpc: new JsonRpc(`${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}`)\n    };\n    this.renderModalButton = this.renderModalButton.bind(this);\n    this.handleDropUpdate = this.handleDropUpdate.bind(this);\n    this.searchDrop = this.searchDrop.bind(this);\n    this.renderDropForm = this.renderDropForm.bind(this);\n    this.buyDrop = this.buyDrop.bind(this);\n\n    this.partition = (str, n) => {\n      var aa = [];\n      var i, l;\n\n      for (i = 0, l = str.length; i < l; i += n) {\n        aa.push(str.substr(i, n));\n      }\n\n      return aa;\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"run\");\n    this._asyncRequest = this.state.rpc.get_table_rows({\n      json: true,\n      code: \"atomicassets\",\n      scope: \"dracodice\",\n      table: \"templates\",\n      lower_bound: \"356879\",\n      limit: 1000,\n      reverse: false,\n      show_payer: false\n    }).then(resp => {\n      this._asyncRequest = null;\n      var ctr = 0;\n\n      for (let itemNdx in resp.rows) {\n        let item = resp.rows[itemNdx];\n\n        if (item.schema_name === \"bcheroes1\") {\n          ctr++;\n          let os = ObjectSchema([{\n            name: \"name\",\n            type: \"string\"\n          }, {\n            name: \"img\",\n            type: \"image\"\n          }, {\n            name: \"series\",\n            type: \"string\"\n          }, {\n            name: \"rarity\",\n            type: \"string\"\n          }, {\n            name: \"material\",\n            type: \"string\"\n          }, {\n            name: \"style\",\n            type: \"string\"\n          }, {\n            name: \"face values\",\n            type: \"string\"\n          }, {\n            name: \"gameimg\",\n            type: \"image\"\n          }, {\n            name: \"video\",\n            type: \"string\"\n          }, {\n            name: \"shape\",\n            type: \"string\"\n          }]);\n          let deserializedData = deserialize(item.immutable_serialized_data, os);\n          item.name = deserializedData.name;\n          item.numberHad = 0; // console.log(item);\n\n          item.imgTag = \"https://ipfs.io/ipfs/\" + deserializedData.img;\n          this.state.drops.push(item);\n        }\n      }\n\n      this.setState(state => ({ ...this.state,\n        ctr: ctr,\n        drops: this.state.drops\n      }));\n    });\n  }\n\n  componentWillUnmount() {\n    if (this._asyncRequest) {\n      this._asyncRequest.cancel();\n    }\n  }\n\n  async buyDrop(buyId, pri) {\n    this.buyClaimContract(buyId, pri);\n  }\n\n  componentDidUpdate() {}\n\n  renderModalButton() {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      className: \"ual-btn-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 12\n      }\n    });\n  }\n\n  async searchAssets(startingAsset) {\n    let resp = await this.state.rpc.get_table_rows({\n      json: true,\n      code: \"atomicassets\",\n      scope: this.state.dropItems,\n      table: \"assets\",\n      lower_bound: startingAsset,\n      limit: 1000,\n      reverse: false,\n      show_payer: false\n    });\n    return resp;\n  }\n\n  render() {\n    return this.renderDropForm();\n  }\n\n}\n\nDropListApp.displayName = \"BCH Draco collection\";\nexport default DropListApp;","map":{"version":3,"sources":["/Users/kevinbadinger/eos/reactdemo/WCWReact/src/components/droplist.jsx"],"names":["JsonRpc","deserialize","ObjectSchema","React","Button","Card","CardHeader","Typography","CardContent","Grid","Form","defaultState","activeUser","accountName","dropItems","drops","statusDisplay","loading","ourNetwork","chainId","rpcEndpoints","protocol","host","port","picture","height","width","cardstyleGreen","border","borderColor","borderStyle","cardstyleRed","DropListApp","Component","constructor","props","renderLogoutBtn","handleDropUpdate","event","etv","target","value","setState","state","searchDrop","lb","newAsset","haveCollection","resp","searchAssets","itemNdx","rows","asset_id","tid","template_id","searchIndex","findIndex","d","itm","numberHad","have","Object","keys","length","sort","a","b","renderDropForm","position","zIndex","top","left","backgroundImage","URl","marginLeft","marginRight","marginTop","display","marginBottom","verticalAlign","textAlign","margin","float","paddingBottom","paddingTop","ctr","map","item","i","desc","name","img","imgTag","drop_id","collection_name","rpc","renderModalButton","bind","buyDrop","partition","str","n","aa","l","push","substr","componentDidMount","console","log","_asyncRequest","get_table_rows","json","code","scope","table","lower_bound","limit","reverse","show_payer","then","schema_name","os","type","deserializedData","immutable_serialized_data","componentWillUnmount","cancel","buyId","pri","buyClaimContract","componentDidUpdate","startingAsset","render","displayName"],"mappings":"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","sourcesContent":["import { JsonRpc } from \"eosjs\";\nimport { deserialize, ObjectSchema } from \"atomicassets\";\nimport React from \"react\";\nimport {\n  Button,\n  Card,\n   \n  CardHeader,\n  Typography,\n  CardContent,\n  Grid, \n} from \"@material-ui/core\";\nimport Form from \"react-bootstrap/Form\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./droplist.css\";\n \nconst defaultState = {\n  activeUser: null,\n  accountName: \"\",\n  dropItems: \"\",\n  drops: [],\n  statusDisplay: \"\",\n  loading: false,\n};\n\nvar ourNetwork = {\n  chainId: \"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4\",\n  rpcEndpoints: [{ protocol: \"https\", host: \"chain.wax.io\", port: \"\" }],\n};\n\nconst picture = {\n  height: \"250px\",\n  width: \"150px\",\n};\n\nconst cardstyleGreen = {\n  border: 10,\n  borderColor: \"green\",\n  borderStyle: \"solid\",\n};\n\nconst cardstyleRed = {\n  border: 10,\n  borderColor: \"red\",\n  borderStyle: \"solid\",\n};\n \n\nclass DropListApp extends React.Component {\n  static displayName = \"BCH Draco collection\";\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      ...defaultState,\n      rows: [],\n      drops: [],\n      ctr: 0,\n      have: 0,\n      rpc: new JsonRpc(\n        `${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}`\n      ),\n    };\n\n    this.renderModalButton = this.renderModalButton.bind(this);\n    this.handleDropUpdate = this.handleDropUpdate.bind(this);\n    this.searchDrop = this.searchDrop.bind(this);\n\n    this.renderDropForm = this.renderDropForm.bind(this);\n    this.buyDrop = this.buyDrop.bind(this);\n \n    this.partition = (str, n) => {\n      var aa = [];\n      var i, l;\n      for (i = 0, l = str.length; i < l; i += n) {\n        aa.push(str.substr(i, n));\n      }\n      return aa;\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"run\");\n\n    this._asyncRequest = this.state.rpc\n      .get_table_rows({\n        json: true,\n        code: \"atomicassets\",\n        scope: \"dracodice\",\n        table: \"templates\",\n        lower_bound: \"356879\",\n        limit: 1000,\n        reverse: false,\n        show_payer: false,\n      })\n      .then((resp) => {\n        this._asyncRequest = null;\n\n        var ctr = 0;\n\n        for (let itemNdx in resp.rows) {\n          let item = resp.rows[itemNdx];\n\n          if (item.schema_name === \"bcheroes1\") {\n            ctr++;\n\n            let os = ObjectSchema([\n              { name: \"name\", type: \"string\" },\n              { name: \"img\", type: \"image\" },\n              { name: \"series\", type: \"string\" },\n              { name: \"rarity\", type: \"string\" },\n              { name: \"material\", type: \"string\" },\n              { name: \"style\", type: \"string\" },\n              { name: \"face values\", type: \"string\" },\n              { name: \"gameimg\", type: \"image\" },\n              { name: \"video\", type: \"string\" },\n              { name: \"shape\", type: \"string\" },\n            ]);\n            let deserializedData = deserialize(\n              item.immutable_serialized_data,\n              os\n            );\n\n            item.name = deserializedData.name;\n            item.numberHad = 0;\n\n            // console.log(item);\n\n            item.imgTag = \"https://ipfs.io/ipfs/\" + deserializedData.img;\n\n            this.state.drops.push(item);\n          }\n        }\n\n        this.setState((state) => ({\n          ...this.state,\n          ctr: ctr,\n          drops: this.state.drops,\n        }));\n      });\n  }\n\n  componentWillUnmount() {\n    if (this._asyncRequest) {\n      this._asyncRequest.cancel();\n    }\n  }\n\n  async buyDrop(buyId, pri) {\n    this.buyClaimContract(buyId, pri);\n  }\n\n  componentDidUpdate() {\n  \n \n  }\n\n  renderLogoutBtn = () => {};\n\n  renderModalButton() {\n    return <p className=\"ual-btn-wrapper\"></p>;\n  }\n\n  handleDropUpdate = (event) => {\n    let etv = event.target.value;\n\n    this.setState((state) => ({\n      ...this.state,\n      dropItems: etv,\n    }));\n  };\n\n  searchDrop = async (event) => {\n    var lb = \"0\";\n\n    var newAsset = \"1\";\n\n    var haveCollection = {};\n\n    while (lb !== newAsset) {\n      newAsset = lb;\n\n      let resp = await this.searchAssets(lb);\n\n      for (let itemNdx in resp.rows) {\n        \n          lb = resp.rows[itemNdx].asset_id;\n\n          var tid = resp.rows[itemNdx].template_id;\n\n          const searchIndex = this.state.drops.findIndex(\n            (d) => d.template_id === resp.rows[itemNdx].template_id\n          );\n\n          if (searchIndex >= 0) {\n            let itm = this.state.drops[searchIndex];\n            itm.numberHad++;\n\n            haveCollection[tid] = 1;\n            this.state.drops[searchIndex] = itm;\n            this.setState((state) => ({\n              ...this.state,\n              have: Object.keys(haveCollection).length,\n              drops: this.state.drops.sort(function(a, b){return a.numberHad-b.numberHad}),\n            }));\n          }\n       \n      }\n    }\n  };\n\n  async searchAssets(startingAsset) {\n    let resp = await this.state.rpc.get_table_rows({\n      json: true,\n      code: \"atomicassets\",\n      scope: this.state.dropItems,\n      table: \"assets\",\n      lower_bound: startingAsset,\n      limit: 1000,\n      reverse: false,\n      show_payer: false,\n    });\n\n    return resp;\n  }\n \n\n  renderDropForm = () => {\n    const { dropItems } = this.state;\n\n   \n    return (\n      <div>\n<div style={{position: \"absolute\", zIndex: \"10\", top: \"0\", left: \"0\" , width: '400px', height: '400px', backgroundImage: URl('./Square-1s-200px.gif')}}></div>\n\n      <div\n        style={{\n          marginLeft: \"auto\",\n          marginRight: \"auto\",\n          width: \"100%\",\n          marginTop: \"40px\",\n          display: \"table\",\n          marginBottom: \"10px\",\n        }}\n      >\n        <div\n          style={{\n            position: \"relative\",\n            verticalAlign: \"middle\",\n            width: \"100%\",\n            display: \"table-cell\",\n          }}\n        >\n          <h2 style={{ marginBottom: \"40px\", textAlign: \"center\" }}>\n            Draco Dice BCH Physical Collection Tools\n          </h2>\n\n          <div\n            style={{ width: \"550px\", margin: \"auto\", verticalAlign: \"middle\" }}\n          >\n            <Form>\n              <Form.Group controlId=\"dropItems\">\n                <div style={{ width: \"150%\" }}>\n                  <div style={{ width: \"300px\", float: \"left\" }}>\n                    <Form.Control\n                      type=\"text\"\n                      name=\"dropItems\"\n                      placeholder=\"Wallet\"\n                      value={dropItems}\n                      onChange={this.handleDropUpdate}\n                    />\n                  </div>\n                  <div style={{ marginLeft: \"305px\" }}>\n                    <Button onClick={this.searchDrop} variant=\"contained\">\n                      Search\n                    </Button>\n                  </div>\n                </div>\n              </Form.Group>\n\n              <Typography variant=\"subtitle2\" component=\"h2\">\n                {this.state.statusDisplay}\n              </Typography>\n            </Form>\n          </div>\n\n          <div\n            style={{\n              margin: \"auto\",\n              textAlign: \"center\",\n              verticalAlign: \"middle\",\n              paddingBottom: \"50px\",\n              paddingTop: \"25px\",\n              width: \"900px\",\n            }}\n          >\n            <h3>\n              BCH Collection Draco Dice (Have {this.state.have} of{\" \"}\n              {this.state.ctr})\n            </h3>\n            <Grid container spacing={4}>\n              {this.state.drops.map(function (item, i) {\n                var desc = item.name;\n\n                var have = item.numberHad;\n\n                \n                let img = \"\";\n\n                if (item.imgTag != null && item.imgTag.length > 0) {\n                  img = <img style={picture} src={item.imgTag}  alt=\"bch dice\" />;\n                }\n\n                return (\n                  <Grid item xs={12} sm={6} md={4} key={item.drop_id}>\n                    <Card style={have > 0 ? cardstyleGreen : cardstyleRed}>\n                      <CardHeader\n                        title={item.collection_name ?? \"\"}\n                        subheader={item.drop_id ?? \"\"}\n                      />\n                      <CardContent>\n                        {img}\n                        <Typography\n                          variant=\"body2\"\n                          color=\"textSecondary\"\n                          component=\"p\"\n                        >\n                          {desc}\n                          <br />\n                          Number of Assets: {have}\n                        </Typography>\n                      </CardContent>\n                    </Card>\n                  </Grid>\n                );\n              })}\n            </Grid>\n          </div>\n        </div>\n        </div> </div>\n   \n   \n   );\n  };\n\n  render() {\n    return this.renderDropForm();\n  }\n}\n\nexport default DropListApp;\n"]},"metadata":{},"sourceType":"module"}