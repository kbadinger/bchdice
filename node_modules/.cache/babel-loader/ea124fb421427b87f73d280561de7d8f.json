{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/kevinbadinger/eos/reactdemo/WCWReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{JsonRpc}from\"eosjs\";import{deserialize,ObjectSchema}from\"atomicassets\";import React from\"react\";import{Button,Card,CardHeader,Typography,CardContent,Grid}from\"@material-ui/core\";import Form from\"react-bootstrap/Form\";import\"bootstrap/dist/css/bootstrap.min.css\";import\"./droplist.css\";var defaultState={activeUser:null,accountName:\"\",dropItems:\"\",drops:[],statusDisplay:\"\"};var ourNetwork={chainId:\"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4\",rpcEndpoints:[{protocol:\"https\",host:\"chain.wax.io\",port:\"\"}]};var picture={height:\"250px\",width:\"150px\"};var cardstyleGreen={border:10,borderColor:\"green\",borderStyle:\"solid\"};var cardstyleRed={border:10,borderColor:\"red\",borderStyle:\"solid\"};var DropListApp=/*#__PURE__*/function(_React$Component){_inherits(DropListApp,_React$Component);var _super=_createSuper(DropListApp);function DropListApp(props){var _this;_classCallCheck(this,DropListApp);_this=_super.call(this,props);_this.renderLogoutBtn=function(){};_this.handleDropUpdate=function(event){var etv=event.target.value;_this.setState(function(state){return _objectSpread(_objectSpread({},_this.state),{},{dropItems:etv});});};_this.searchDrop=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var lb,newAsset,haveCollection,_loop,tid;return _regeneratorRuntime.wrap(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:lb=\"0\";newAsset=\"1\";haveCollection={};_loop=/*#__PURE__*/_regeneratorRuntime.mark(function _loop(){var resp,_loop2,itemNdx;return _regeneratorRuntime.wrap(function _loop$(_context){while(1){switch(_context.prev=_context.next){case 0:newAsset=lb;_context.next=3;return _this.searchAssets(lb);case 3:resp=_context.sent;_loop2=function _loop2(itemNdx){lb=resp.rows[itemNdx].asset_id;tid=resp.rows[itemNdx].template_id;var searchIndex=_this.state.drops.findIndex(function(d){return d.template_id===resp.rows[itemNdx].template_id;});if(searchIndex>=0){var itm=_this.state.drops[searchIndex];itm.numberHad++;haveCollection[tid]=1;_this.state.drops[searchIndex]=itm;_this.setState(function(state){return _objectSpread(_objectSpread({},_this.state),{},{have:Object.keys(haveCollection).length,drops:_this.state.drops.sort(function(a,b){return a.numberHad-b.numberHad;})});});}};for(itemNdx in resp.rows){_loop2(itemNdx);}case 6:case\"end\":return _context.stop();}}},_loop);});case 4:if(!(lb!==newAsset)){_context2.next=8;break;}return _context2.delegateYield(_loop(),\"t0\",6);case 6:_context2.next=4;break;case 8:case\"end\":return _context2.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.renderDropForm=function(){var dropItems=_this.state.dropItems;return/*#__PURE__*/React.createElement(\"div\",{style:{marginLeft:\"auto\",marginRight:\"auto\",width:\"100%\",marginTop:\"40px\",display:\"table\",marginBottom:\"10px\"}},/*#__PURE__*/React.createElement(\"div\",{style:{position:\"relative\",verticalAlign:\"middle\",width:\"100%\",display:\"table-cell\"}},/*#__PURE__*/React.createElement(\"h2\",{style:{marginBottom:\"40px\",textAlign:\"center\"}},\"Draco Dice BCH Physical Collection Tools\"),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"550px\",margin:\"auto\",verticalAlign:\"middle\"}},/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(Form.Group,{controlId:\"dropItems\"},/*#__PURE__*/React.createElement(\"div\",{style:{width:\"150%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{width:\"300px\",float:\"left\"}},/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",name:\"dropItems\",placeholder:\"Wallet\",value:dropItems,onChange:_this.handleDropUpdate})),/*#__PURE__*/React.createElement(\"div\",{style:{marginLeft:\"305px\"}},/*#__PURE__*/React.createElement(Button,{onClick:_this.searchDrop,variant:\"contained\"},\"Search\")))),/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle2\",component:\"h2\"},_this.state.statusDisplay))),/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"auto\",textAlign:\"center\",verticalAlign:\"middle\",paddingBottom:\"50px\",paddingTop:\"25px\",width:\"900px\"}},/*#__PURE__*/React.createElement(\"h3\",null,\"BCH Collection Draco Dice (Have \",_this.state.have,\" of\",\" \",_this.state.ctr,\")\"),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:4},_this.state.drops.map(function(item,i){var _item$collection_name,_item$drop_id;var desc=item.name;var have=item.numberHad;var img=\"\";if(item.imgTag!=null&&item.imgTag.length>0){img=/*#__PURE__*/React.createElement(\"img\",{style:picture,src:item.imgTag,alt:\"bch dice\"});}return/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:6,md:4,key:item.drop_id},/*#__PURE__*/React.createElement(Card,{style:have>0?cardstyleGreen:cardstyleRed},/*#__PURE__*/React.createElement(CardHeader,{title:(_item$collection_name=item.collection_name)!==null&&_item$collection_name!==void 0?_item$collection_name:\"\",subheader:(_item$drop_id=item.drop_id)!==null&&_item$drop_id!==void 0?_item$drop_id:\"\"}),/*#__PURE__*/React.createElement(CardContent,null,img,/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",color:\"textSecondary\",component:\"p\"},desc,/*#__PURE__*/React.createElement(\"br\",null),\"Number of Assets: \",have))));})))));};_this.state=_objectSpread(_objectSpread({},defaultState),{},{rows:[],drops:[],ctr:0,have:0,rpc:new JsonRpc(\"\".concat(ourNetwork.rpcEndpoints[0].protocol,\"://\").concat(ourNetwork.rpcEndpoints[0].host))});_this.renderModalButton=_this.renderModalButton.bind(_assertThisInitialized(_this));_this.handleDropUpdate=_this.handleDropUpdate.bind(_assertThisInitialized(_this));_this.searchDrop=_this.searchDrop.bind(_assertThisInitialized(_this));_this.renderDropForm=_this.renderDropForm.bind(_assertThisInitialized(_this));_this.buyDrop=_this.buyDrop.bind(_assertThisInitialized(_this));_this.partition=function(str,n){var aa=[];var i,l;for(i=0,l=str.length;i<l;i+=n){aa.push(str.substr(i,n));}return aa;};return _this;}_createClass(DropListApp,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;console.log(\"run\");this._asyncRequest=this.state.rpc.get_table_rows({json:true,code:\"atomicassets\",scope:\"dracodice\",table:\"templates\",lower_bound:\"356879\",limit:1000,reverse:false,show_payer:false}).then(function(resp){_this2._asyncRequest=null;var ctr=0;for(var itemNdx in resp.rows){var item=resp.rows[itemNdx];if(item.schema_name===\"bcheroes1\"){ctr++;var os=ObjectSchema([{name:\"name\",type:\"string\"},{name:\"img\",type:\"image\"},{name:\"series\",type:\"string\"},{name:\"rarity\",type:\"string\"},{name:\"material\",type:\"string\"},{name:\"style\",type:\"string\"},{name:\"face values\",type:\"string\"},{name:\"gameimg\",type:\"image\"},{name:\"video\",type:\"string\"},{name:\"shape\",type:\"string\"}]);var deserializedData=deserialize(item.immutable_serialized_data,os);item.name=deserializedData.name;item.numberHad=0;// console.log(item);\nitem.imgTag=\"https://ipfs.io/ipfs/\"+deserializedData.img;_this2.state.drops.push(item);}}_this2.setState(function(state){return _objectSpread(_objectSpread({},_this2.state),{},{ctr:ctr,drops:_this2.state.drops});});});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this._asyncRequest){this._asyncRequest.cancel();}}},{key:\"buyDrop\",value:function(){var _buyDrop=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(buyId,pri){return _regeneratorRuntime.wrap(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.buyClaimContract(buyId,pri);case 1:case\"end\":return _context3.stop();}}},_callee2,this);}));function buyDrop(_x2,_x3){return _buyDrop.apply(this,arguments);}return buyDrop;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(){}},{key:\"renderModalButton\",value:function renderModalButton(){return/*#__PURE__*/React.createElement(\"p\",{className:\"ual-btn-wrapper\"});}},{key:\"searchAssets\",value:function(){var _searchAssets=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(startingAsset){var resp;return _regeneratorRuntime.wrap(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.state.rpc.get_table_rows({json:true,code:\"atomicassets\",scope:this.state.dropItems,table:\"assets\",lower_bound:startingAsset,limit:1000,reverse:false,show_payer:false});case 2:resp=_context4.sent;return _context4.abrupt(\"return\",resp);case 4:case\"end\":return _context4.stop();}}},_callee3,this);}));function searchAssets(_x4){return _searchAssets.apply(this,arguments);}return searchAssets;}()},{key:\"render\",value:function render(){return this.renderDropForm();}}]);return DropListApp;}(React.Component);DropListApp.displayName=\"BCH Draco collection\";export default DropListApp;","map":{"version":3,"sources":["/Users/kevinbadinger/eos/reactdemo/WCWReact/src/components/droplist.jsx"],"names":["JsonRpc","deserialize","ObjectSchema","React","Button","Card","CardHeader","Typography","CardContent","Grid","Form","defaultState","activeUser","accountName","dropItems","drops","statusDisplay","ourNetwork","chainId","rpcEndpoints","protocol","host","port","picture","height","width","cardstyleGreen","border","borderColor","borderStyle","cardstyleRed","DropListApp","props","renderLogoutBtn","handleDropUpdate","event","etv","target","value","setState","state","searchDrop","lb","newAsset","haveCollection","searchAssets","resp","itemNdx","rows","asset_id","tid","template_id","searchIndex","findIndex","d","itm","numberHad","have","Object","keys","length","sort","a","b","renderDropForm","marginLeft","marginRight","marginTop","display","marginBottom","position","verticalAlign","textAlign","margin","float","paddingBottom","paddingTop","ctr","map","item","i","desc","name","img","imgTag","drop_id","collection_name","rpc","renderModalButton","bind","buyDrop","partition","str","n","aa","l","push","substr","console","log","_asyncRequest","get_table_rows","json","code","scope","table","lower_bound","limit","reverse","show_payer","then","schema_name","os","type","deserializedData","immutable_serialized_data","cancel","buyId","pri","buyClaimContract","startingAsset","Component","displayName"],"mappings":"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","sourcesContent":["import { JsonRpc } from \"eosjs\";\nimport { deserialize, ObjectSchema } from \"atomicassets\";\nimport React from \"react\";\nimport {\n  Button,\n  Card,\n   \n  CardHeader,\n  Typography,\n  CardContent,\n  Grid, \n} from \"@material-ui/core\";\nimport Form from \"react-bootstrap/Form\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./droplist.css\";\n \nconst defaultState = {\n  activeUser: null,\n  accountName: \"\",\n  dropItems: \"\",\n  drops: [],\n  statusDisplay: \"\",\n};\n\nvar ourNetwork = {\n  chainId: \"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4\",\n  rpcEndpoints: [{ protocol: \"https\", host: \"chain.wax.io\", port: \"\" }],\n};\n\nconst picture = {\n  height: \"250px\",\n  width: \"150px\",\n};\n\nconst cardstyleGreen = {\n  border: 10,\n  borderColor: \"green\",\n  borderStyle: \"solid\",\n};\n\nconst cardstyleRed = {\n  border: 10,\n  borderColor: \"red\",\n  borderStyle: \"solid\",\n};\n \n\nclass DropListApp extends React.Component {\n  static displayName = \"BCH Draco collection\";\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      ...defaultState,\n      rows: [],\n      drops: [],\n      ctr: 0,\n      have: 0,\n      rpc: new JsonRpc(\n        `${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}`\n      ),\n    };\n\n    this.renderModalButton = this.renderModalButton.bind(this);\n    this.handleDropUpdate = this.handleDropUpdate.bind(this);\n    this.searchDrop = this.searchDrop.bind(this);\n\n    this.renderDropForm = this.renderDropForm.bind(this);\n    this.buyDrop = this.buyDrop.bind(this);\n \n    this.partition = (str, n) => {\n      var aa = [];\n      var i, l;\n      for (i = 0, l = str.length; i < l; i += n) {\n        aa.push(str.substr(i, n));\n      }\n      return aa;\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"run\");\n\n    this._asyncRequest = this.state.rpc\n      .get_table_rows({\n        json: true,\n        code: \"atomicassets\",\n        scope: \"dracodice\",\n        table: \"templates\",\n        lower_bound: \"356879\",\n        limit: 1000,\n        reverse: false,\n        show_payer: false,\n      })\n      .then((resp) => {\n        this._asyncRequest = null;\n\n        var ctr = 0;\n\n        for (let itemNdx in resp.rows) {\n          let item = resp.rows[itemNdx];\n\n          if (item.schema_name === \"bcheroes1\") {\n            ctr++;\n\n            let os = ObjectSchema([\n              { name: \"name\", type: \"string\" },\n              { name: \"img\", type: \"image\" },\n              { name: \"series\", type: \"string\" },\n              { name: \"rarity\", type: \"string\" },\n              { name: \"material\", type: \"string\" },\n              { name: \"style\", type: \"string\" },\n              { name: \"face values\", type: \"string\" },\n              { name: \"gameimg\", type: \"image\" },\n              { name: \"video\", type: \"string\" },\n              { name: \"shape\", type: \"string\" },\n            ]);\n            let deserializedData = deserialize(\n              item.immutable_serialized_data,\n              os\n            );\n\n            item.name = deserializedData.name;\n            item.numberHad = 0;\n\n            // console.log(item);\n\n            item.imgTag = \"https://ipfs.io/ipfs/\" + deserializedData.img;\n\n            this.state.drops.push(item);\n          }\n        }\n\n        this.setState((state) => ({\n          ...this.state,\n          ctr: ctr,\n          drops: this.state.drops,\n        }));\n      });\n  }\n\n  componentWillUnmount() {\n    if (this._asyncRequest) {\n      this._asyncRequest.cancel();\n    }\n  }\n\n  async buyDrop(buyId, pri) {\n    this.buyClaimContract(buyId, pri);\n  }\n\n  componentDidUpdate() {\n  \n \n  }\n\n  renderLogoutBtn = () => {};\n\n  renderModalButton() {\n    return <p className=\"ual-btn-wrapper\"></p>;\n  }\n\n  handleDropUpdate = (event) => {\n    let etv = event.target.value;\n\n    this.setState((state) => ({\n      ...this.state,\n      dropItems: etv,\n    }));\n  };\n\n  searchDrop = async (event) => {\n    var lb = \"0\";\n\n    var newAsset = \"1\";\n\n    var haveCollection = {};\n\n    while (lb !== newAsset) {\n      newAsset = lb;\n\n      let resp = await this.searchAssets(lb);\n\n      for (let itemNdx in resp.rows) {\n        \n          lb = resp.rows[itemNdx].asset_id;\n\n          var tid = resp.rows[itemNdx].template_id;\n\n          const searchIndex = this.state.drops.findIndex(\n            (d) => d.template_id === resp.rows[itemNdx].template_id\n          );\n\n          if (searchIndex >= 0) {\n            let itm = this.state.drops[searchIndex];\n            itm.numberHad++;\n\n            haveCollection[tid] = 1;\n            this.state.drops[searchIndex] = itm;\n            this.setState((state) => ({\n              ...this.state,\n              have: Object.keys(haveCollection).length,\n              drops: this.state.drops.sort(function(a, b){return a.numberHad-b.numberHad}),\n            }));\n          }\n       \n      }\n    }\n  };\n\n  async searchAssets(startingAsset) {\n    let resp = await this.state.rpc.get_table_rows({\n      json: true,\n      code: \"atomicassets\",\n      scope: this.state.dropItems,\n      table: \"assets\",\n      lower_bound: startingAsset,\n      limit: 1000,\n      reverse: false,\n      show_payer: false,\n    });\n\n    return resp;\n  }\n \n\n  renderDropForm = () => {\n    const { dropItems } = this.state;\n\n   \n    return (\n      <div\n        style={{\n          marginLeft: \"auto\",\n          marginRight: \"auto\",\n          width: \"100%\",\n          marginTop: \"40px\",\n          display: \"table\",\n          marginBottom: \"10px\",\n        }}\n      >\n        <div\n          style={{\n            position: \"relative\",\n            verticalAlign: \"middle\",\n            width: \"100%\",\n            display: \"table-cell\",\n          }}\n        >\n          <h2 style={{ marginBottom: \"40px\", textAlign: \"center\" }}>\n            Draco Dice BCH Physical Collection Tools\n          </h2>\n\n          <div\n            style={{ width: \"550px\", margin: \"auto\", verticalAlign: \"middle\" }}\n          >\n            <Form>\n              <Form.Group controlId=\"dropItems\">\n                <div style={{ width: \"150%\" }}>\n                  <div style={{ width: \"300px\", float: \"left\" }}>\n                    <Form.Control\n                      type=\"text\"\n                      name=\"dropItems\"\n                      placeholder=\"Wallet\"\n                      value={dropItems}\n                      onChange={this.handleDropUpdate}\n                    />\n                  </div>\n                  <div style={{ marginLeft: \"305px\" }}>\n                    <Button onClick={this.searchDrop} variant=\"contained\">\n                      Search\n                    </Button>\n                  </div>\n                </div>\n              </Form.Group>\n\n              <Typography variant=\"subtitle2\" component=\"h2\">\n                {this.state.statusDisplay}\n              </Typography>\n            </Form>\n          </div>\n\n          <div\n            style={{\n              margin: \"auto\",\n              textAlign: \"center\",\n              verticalAlign: \"middle\",\n              paddingBottom: \"50px\",\n              paddingTop: \"25px\",\n              width: \"900px\",\n            }}\n          >\n            <h3>\n              BCH Collection Draco Dice (Have {this.state.have} of{\" \"}\n              {this.state.ctr})\n            </h3>\n            <Grid container spacing={4}>\n              {this.state.drops.map(function (item, i) {\n                var desc = item.name;\n\n                var have = item.numberHad;\n\n                \n                let img = \"\";\n\n                if (item.imgTag != null && item.imgTag.length > 0) {\n                  img = <img style={picture} src={item.imgTag}  alt=\"bch dice\" />;\n                }\n\n                return (\n                  <Grid item xs={12} sm={6} md={4} key={item.drop_id}>\n                    <Card style={have > 0 ? cardstyleGreen : cardstyleRed}>\n                      <CardHeader\n                        title={item.collection_name ?? \"\"}\n                        subheader={item.drop_id ?? \"\"}\n                      />\n                      <CardContent>\n                        {img}\n                        <Typography\n                          variant=\"body2\"\n                          color=\"textSecondary\"\n                          component=\"p\"\n                        >\n                          {desc}\n                          <br />\n                          Number of Assets: {have}\n                        </Typography>\n                      </CardContent>\n                    </Card>\n                  </Grid>\n                );\n              })}\n            </Grid>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  render() {\n    return this.renderDropForm();\n  }\n}\n\nexport default DropListApp;\n"]},"metadata":{},"sourceType":"module"}